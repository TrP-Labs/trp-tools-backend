// Group

model Group {
  id            String @id @unique @default(uuid())
  robloxId      String
  createdAt     DateTime @default(now())

  ranks         RankRelation[]
  audit         AuditMessage[]
  routes        Route[]
  events        Event[]
  bot           BotConfig?
}

model RankRelation {
  id            String @id @unique @default(uuid())
  robloxId      String @unique
  color         String
  visible       Boolean

  cached_name   String
  cached_rank   Int

  permission_level Int

  max_activity  Int?
  min_activity  Int?

  staffRequestObject StaffRequest?
  group         Group @relation(fields: [groupId], references: [id])
  groupId       String
}

model AuditMessage {
  id            String @id @unique @default(uuid())

  Changed       String
  Date          DateTime @default(now())

  group         Group @relation(fields: [groupId], references: [id])
  groupId       String
}

// Routes

model Route {
  id            String @id @default(uuid())
  Group         Group @relation(fields: [GroupId], references: [id])
  GroupId       String

  favoredBy     User[] @relation("FavoriteRoutes")
  dislikedBy    User[] @relation("DislikedRoutes")

  Name          String
  Description   String
  Color         String
}

// Bot

model BotConfig {
  id            String @id @default(uuid())
  group         Group @relation(fields: [groupId], references: [id])
  groupId       String @unique

  guildId       String
  
  announcementChannel String?
  pollChannel   String?

  staffRequests StaffRequest[]
}

model StaffRequest {
  id            String @id @default(uuid())
  parentConfig  BotConfig @relation(fields: [parentId], references: [id])
  parentId      String

  announcementChannel String
  slots         String[]
  bindedRank    RankRelation @relation(fields: [bindedRankId], references: [id])
  bindedRankId  String @unique
}